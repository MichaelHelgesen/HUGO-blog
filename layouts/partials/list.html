<ul class="flex flex-col gap-9">
    
    {{ $source := .type }}
    {{ $sourceType := "" }}
    {{ $sourceTag := "" }}
    {{ $page := .page }}

    {{ range .range}}
        {{ if $source }}
            {{ if eq .data.itemType "book" }}
                {{ $sourceType = "bok" }}
            {{ else if eq .data.itemType "blogPost"}}
                {{ $sourceType = "bloggartikkel" }}
            {{ else if eq .data.itemType "videoRecording"}}
                {{ $sourceType = "video" }}
            {{ end }}
        {{ end }}
        
        {{if $source }}
            {{ range .data.tags }}
                {{ $sourceTag = .tag }}
            {{ end }}
        {{ end }}
        
        <li>
            {{ if or (eq $page "home") (eq $page "term")}}
                <div>{{ .Type }}</div>
            {{ end }}

            {{ if $source }}
                <small>{{ $sourceType }}</small>
            {{ end }}

            <h2 class="text-2xl font-bold">
                {{ if and .Type (ne .Type "læringslogg")}}
                    <a href="{{ .RelPermalink }}">{{ .Title }}</a>
                {{else if eq .Type "læringslogg" }}    
                    <a href="{{ .RelPermalink }}">{{ .Title | dateFormat ":date_full" }}</a>
                {{ else if $source }}
                    <a href="{{.data.url}}" id={{ $sourceTag }}>{{.data.title}}</a> 
                {{ else }}
                    <a href="{{.link}}">{{.title}}</a> 
                {{ end }}
            </h2>
            
            {{ if and .Type (ne .Type "læringslogg") }}
                {{ .Date | time.Format ":date_medium" }}
                {{ .Lastmod | time.Format ":date_medium" }}
            {{ end }}
            
            {{ if eq .Type "læringslogg" }}
                {{.Content}}
            {{ end }}

            {{/* API-sider */}}
            {{ if not .Type }}
                {{ with .data }}
                    <ul>
                        {{ range .creators }}
                            <li>{{ .firstName }} {{ .lastName }}</li>
                        {{ end }}
                    </ul>
                {{ end }}
                
                {{ if .excerpt }}
                    <blockquote>
                        <p>
                            {{ .excerpt }}
                        </p>
                    </blockquote>
                    <div>
                        <a href="{{ .link }}">
                            {{ .domain }}
                        </a>
                    </div>
                {{ end }}
            {{ end }}
            
            {{ if $source}}
                <ul>
                    {{- range site.RegularPages -}}
                        {{ if in .RawContent $sourceTag }}
                            <li>
                                <a href="{{ .Page.Permalink }}">{{.Title}}</a>
                                <small>{{ .Type }}</small>
                                {{ partial "tags.html" .}}
                            </li>
                        {{ end }}
                    {{- end -}}
                </ul>
            {{ end }}
            
            {{/* Show tags if any */}}
            {{ if .Type }}
                {{ partial "tags.html" .}}
            {{ end }}
        </li>
    {{ end }}
</ul>
